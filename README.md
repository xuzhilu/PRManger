# PRManager - é£ä¹¦æ™ºèƒ½PRå®¡æŸ¥åŠ©æ‰‹


## ğŸ“– é¡¹ç›®ç®€ä»‹

PRManager æ˜¯ä¸€ä¸ªé›†æˆé£ä¹¦æœºå™¨äººçš„æ™ºèƒ½ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼Œé€šè¿‡é£ä¹¦ä¸å›¢é˜Ÿæˆå‘˜äº¤äº’ï¼Œè‡ªåŠ¨åˆ†æ Git åˆ†æ”¯åˆå¹¶æä¾›ä¸“ä¸šçš„å®¡æŸ¥æ„è§ã€‚æ‰€æœ‰AIæ¨ç†åœ¨æœ¬åœ°è¿è¡Œï¼ˆåŸºäºOllamaï¼‰ï¼Œä¿æŠ¤ä»£ç éšç§ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

| å·¥å…· | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| Python | 3.11.14 | è¿è¡Œç¯å¢ƒ |
| Git | 2.51.1 | ä»£ç ä»“åº“ç®¡ç† |

### 1ï¸âƒ£ å®‰è£…é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/StarlightGuide/PRManger.git
cd PRManger

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt
```

### 2ï¸âƒ£ å®‰è£…Ollamaå’Œæ¨¡å‹

```bash
# å®‰è£…Ollamaï¼ˆå‚è€ƒ https://ollama.ai/downloadï¼‰

```

### 3ï¸âƒ£ å®‰è£…ripgrep

```bash
# Windows
choco install ripgrep

# macOS
brew install ripgrep

# Ubuntu/Debian
sudo apt-get install ripgrep

# CentOS/RHEL
sudo yum install ripgrep
```

### 4ï¸âƒ£ é…ç½®ç³»ç»Ÿ

#### ç¼–è¾‘é…ç½®æ–‡ä»¶

ç¼–è¾‘ `config/config.yaml`ï¼Œå¡«å†™å®é™…é…ç½®ï¼š

#### é£ä¹¦é…ç½®è¯´æ˜(https://open.feishu.cn/)
- åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨
- `app_id,app_secret`:[åº”ç”¨å‡­è¯](images/å‡­è¯.png)
- [æƒé™ç”³è¯·](images/æƒé™ç”³è¯·.png)
- è¿è¡Œ main.py å»ºç«‹é•¿è¿æ¥
- [äº‹ä»¶é…ç½®](images/äº‹ä»¶é…ç½®.png)
- `verification_token,encrypt_key`:[è®¢é˜…é…ç½®](images/è®¢é˜…é…ç½®.png)
- åˆ›å»ºç‰ˆæœ¬å‘å¸ƒåº”ç”¨
- `admins`:æ‰“å¼€APIè°ƒè¯•å°(https://open.feishu.cn/api-explorer/)[ç®¡ç†å‘˜id](images/ç®¡ç†å‘˜id.png)

### å¯åŠ¨ç³»ç»Ÿ

```bash
python main.py
```


## ğŸ“± ä½¿ç”¨è¯´æ˜

### åœ¨é£ä¹¦ä¸­ä½¿ç”¨

#### 1. æ·»åŠ æœºå™¨äºº

åœ¨é£ä¹¦ä¸­æœç´¢ä½ çš„æœºå™¨äººåç§°å¹¶æ·»åŠ åˆ°å¯¹è¯

#### 2. è§¦å‘PRå®¡æŸ¥

å‘é€ä»¥ä¸‹æ ¼å¼çš„æ¶ˆæ¯ï¼š

```
ä¿®æ”¹åˆ†æ”¯ merge åŸåˆ†æ”¯
```

#### 3. ç­‰å¾…å®¡æŸ¥ç»“æœ

ç³»ç»Ÿä¼šï¼š
1. âœ… ç¡®è®¤æ”¶åˆ°è¯·æ±‚
2. ğŸ“Š æ¨é€è¯¦ç»†å®¡æŸ¥æŠ¥å‘Š


### æ ¸å¿ƒç»„ä»¶

#### ğŸ“ ç›®å½•ç»“æ„

```
PRManger/
â”œâ”€â”€ main.py                 # ç¨‹åºå…¥å£
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.yaml.example  # é…ç½®æ¨¡æ¿
â”‚   â”œâ”€â”€ config.yaml          # ç³»ç»Ÿé…ç½®
â”‚   â””â”€â”€ code_rules.yaml      # ç¼–ç è§„èŒƒ
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agents/            # æ™ºèƒ½ä½“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ listener_agent.py        # æ¶ˆæ¯ç›‘å¬
â”‚   â”‚   â”œâ”€â”€ decision_agent.py        # ç­–ç•¥å†³ç­–
â”‚   â”‚   â”œâ”€â”€ code_analyzer_agent.py   # ä»£ç åˆ†æ
â”‚   â”‚   â”œâ”€â”€ context_collector_agent.py # ä¸Šä¸‹æ–‡æ”¶é›†
â”‚   â”‚   â”œâ”€â”€ feedback_agent.py        # æŠ¥å‘Šç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ git_review_agent.py      # Gitæ“ä½œ
â”‚   â”œâ”€â”€ analyzers/         # åˆ†æå™¨
â”‚   â”‚   â””â”€â”€ project_analyzer/
â”‚   â”‚       â”œâ”€â”€ ast_parser.py           # Tree-sitterè§£æ
â”‚   â”‚       â”œâ”€â”€ fast_file_searcher.py   # ripgrepæœç´¢
â”‚   â”‚       â””â”€â”€ code_parser.py          # æ­£åˆ™è§£æ
â”‚   â”œâ”€â”€ adapters/          # å¤–éƒ¨é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ feishu_adapter.py  # é£ä¹¦SDK
â”‚   â”‚   â””â”€â”€ git_adapter.py     # Gitæ“ä½œ
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ workflow.py    # LangGraphå·¥ä½œæµ
â”‚   â”‚   â””â”€â”€ state.py       # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ llm.py         # LLMè°ƒç”¨
â”‚       â”œâ”€â”€ config.py      # é…ç½®åŠ è½½
â”‚       â””â”€â”€ thread_safe_logger.py # æ—¥å¿—
â””â”€â”€ logs/                  # è¿è¡Œæ—¥å¿—
```

#### ğŸ”„ å·¥ä½œæµç¨‹

1. **ç›‘å¬é˜¶æ®µ** - é£ä¹¦æœºå™¨äººæ¥æ”¶ç”¨æˆ·æ¶ˆæ¯
2. **è§£æé˜¶æ®µ** - æå–ä¿¡æ¯
3. **å†³ç­–é˜¶æ®µ** - è¯„ä¼°diffè§„æ¨¡ï¼Œé€‰æ‹©å®¡æŸ¥ç­–ç•¥
4. **åˆ†æé˜¶æ®µ** - è¿­ä»£åˆ†æä»£ç å˜æ›´å’Œå½±å“èŒƒå›´
   - ç¬¬1è½®ï¼šåˆ†æç›´æ¥å˜æ›´
   - ç¬¬2è½®ï¼šæ”¶é›†ç›¸å…³ä¸Šä¸‹æ–‡
   - ç¬¬3è½®ï¼šæ·±åº¦å½±å“è¯„ä¼°
5. **æŠ¥å‘Šé˜¶æ®µ** - ç”Ÿæˆç»“æ„åŒ–å®¡æŸ¥æŠ¥å‘Š
6. **æäº¤é˜¶æ®µ** - æ¨é€ç»“æœåˆ°é£ä¹¦